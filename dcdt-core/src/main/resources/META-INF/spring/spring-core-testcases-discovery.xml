<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:c="http://www.springframework.org/schema/c"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:dcdt="http://direct-test.com/spring/schema/spring-dcdt"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://direct-test.com/spring/schema/spring-dcdt http://direct-test.com/spring/schema/spring-dcdt.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">
    
    <beans:bean id="discoveryTestcase" class="gov.hhs.onc.dcdt.testcases.discovery.DiscoveryTestcase" parent="toolTestcase" abstract="true"/>
    <beans:bean id="discoveryTestcaseDesc" class="gov.hhs.onc.dcdt.testcases.discovery.DiscoveryTestcaseDescription" parent="toolTestcaseDesc" abstract="true"/>
    <beans:bean id="discoveryTestcaseResult" class="gov.hhs.onc.dcdt.testcases.discovery.DiscoveryTestcaseResult" parent="toolTestcaseResult" abstract="true"/>
    <beans:bean id="discoveryTestcaseCred" class="gov.hhs.onc.dcdt.testcases.discovery.DiscoveryTestcaseCredential" abstract="true"/>
    
    <beans:bean id="discoveryTestcaseImpl" class="gov.hhs.onc.dcdt.testcases.discovery.impl.DiscoveryTestcaseFactoryBean" parent="discoveryTestcase"
        abstract="true"/>
    <beans:bean id="discoveryTestcaseDescImpl" class="gov.hhs.onc.dcdt.testcases.discovery.impl.DiscoveryTestcaseDescriptionImpl" parent="discoveryTestcaseDesc"
        abstract="true"/>
    <beans:bean id="discoveryTestcaseResultImpl" class="gov.hhs.onc.dcdt.testcases.discovery.impl.DiscoveryTestcaseResultImpl" parent="toolTestcaseResult"
        abstract="true"/>
    <beans:bean id="discoveryTestcaseCredImpl" class="gov.hhs.onc.dcdt.testcases.discovery.impl.DiscoveryTestcaseCredentialImpl" parent="discoveryTestcaseCred"
        abstract="true"/>
    
    <!--====================================================================================================
    = DISCOVERY TESTCASE STRINGS
    =====================================================================================================-->
    <dcdt:normalized-string id="discoveryTestcaseConstantStrVerifyEmail">
        You should have received an email indicating the test case results for your system. Examine the results
        to see if your system passed the test case. If you do not receive a message for the test case\, then you
        should assume that the test case failed.
    </dcdt:normalized-string>

    <dcdt:normalized-string id="discoveryTestcaseConstantStrVerifyNoEmail">
        Verify that your system did NOT send an email because it could not find a certificate for the Direct address.
        To pass this test case\, you must NOT receive an email in response.
    </dcdt:normalized-string>
    
    <!--====================================================================================================
    = DISCOVERY TESTCASE RESULTS
    =====================================================================================================-->
    <beans:bean id="discoveryTestcaseResultPassed" parent="discoveryTestcaseResultImpl"
        p:passed="true"
        p:message="This test case passed. Your system discovered the expected certificate."/>

    <beans:bean id="discoveryTestcaseResultFailed" parent="discoveryTestcaseResultImpl"
        p:message="This test case failed. Your system discovered the wrong certificate."/>
    
    <!--====================================================================================================
    = DISCOVERY TESTCASE CA
    =====================================================================================================-->
    <beans:bean id="discoveryTestcaseCaKeyConfig" parent="caKeyConfigImpl"/>
    
    <beans:bean id="discoveryTestcaseCaCertConfig" parent="caCertConfigImpl">
        <beans:property name="subject">
            <beans:bean parent="certNameImpl"
                p:commonName="#{ instanceConfig.domain }_ca"/>
        </beans:property>
    </beans:bean>
    
    <beans:bean id="discoveryTestcaseCaCred" parent="discoveryTestcaseCredImpl">
        <beans:property name="credentialConfig">
            <beans:bean parent="caCredConfigImpl"
                p:certificateDescriptor-ref="discoveryTestcaseCaCertConfig"
                p:keyDescriptor-ref="discoveryTestcaseCaKeyConfig"/>
        </beans:property>
        <beans:qualifier type="gov.hhs.onc.dcdt.crypto.CertificateAuthority"/>
    </beans:bean>
    
    <beans:bean id="discoveryTestcaseLeafCred" parent="discoveryTestcaseCredImpl" abstract="true"
        p:issuerCredential-ref="discoveryTestcaseCaCred"/>
    
    <!--====================================================================================================
    = DISCOVERY TESTCASES
    =====================================================================================================-->
    <beans:bean id="discoveryTestcase1Key1Config" parent="keyConfigImpl"/>
    <beans:bean id="discoveryTestcase1Cert1Config" parent="certConfigImpl">
        <beans:property name="subject">
            <beans:bean parent="certNameImpl"
                p:commonName="d1@domain1.#{ instanceConfig.domain }"
                p:mailAddress="d1@domain1.#{ instanceConfig.domain }"/>
        </beans:property>
    </beans:bean>
    <beans:bean id="discoveryTestcase1" parent="discoveryTestcaseImpl"
        p:mailAddress="d1@domain1.#{ instanceConfig.domain }"
        p:name="D1_DNS_AB_Valid"
        p:nameDisplay="D1 - Valid address-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="1\, 3">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>
                            A valid and invalid domain-bound certificate for the Direct address in a DNS CERT record.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Invalid address-bound and domain-bound certificates for the Direct address in an LDAP server
                            with an associated SRV record.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound certificates for other Direct addresses in DNS CERT records.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 4398: Section 2.1</dcdt:normalized-string>
                        <dcdt:normalized-string>Direct Applicability Statement for Secure Health Transport: Sections 4.0 and 5.3</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid address-bound certificate in a DNS CERT record containing the Direct address in the
                        rfc822Name of the SubjectAlternativeName extension.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and discover
                        a valid address-bound X.509 certificate for a Direct address.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase1Cert1Config"
                            p:keyDescriptor-ref="discoveryTestcase1Key1Config"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase2" parent="discoveryTestcaseImpl"
        p:mailAddress="d2@domain1.#{ instanceConfig.domain }"
        p:name="D2_DNS_DB_Valid"
        p:nameDisplay="D2 - Valid domain-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="1\, 3">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>An invalid domain-bound certificate for the Direct address in a DNS CERT record.</dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Invalid address-bound and domain-bound certificates for the Direct address in an LDAP server
                            with an associated SRV record.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound certificates for other Direct addresses in DNS CERT records.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 4398: Section 2.1</dcdt:normalized-string>
                        <dcdt:normalized-string>Direct Applicability Statement for Secure Health Transport: Sections 4.0 and 5.3</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid domain-bound certificate in a DNS CERT record containing the Direct address' domain name
                        in the dNSName of the SubjectAlternativeName extension.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for domain-bound CERT records and discover
                        a valid domain-bound X.509 certificate for a Direct address.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase2Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase2KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase3" parent="discoveryTestcaseImpl"
        p:mailAddress="d3@domain2.#{ instanceConfig.domain }"
        p:name="D3_LDAP_AB_Valid"
        p:nameDisplay="D3 - Valid address-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="2\, 3\, 5\, 6\, 7\, 8\, 9\, 10\, 11\, 12\, 13\, 14\, 15\, 16\, 17\, 19\, 20\, 21\, 22">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>
                            A valid and invalid domain-bound certificate for the Direct address in an LDAP server with
                            an associated SRV record.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound certificates for other Direct addresses in an LDAP server
                            with an associated SRV record.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2798: Section 9.1.2</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                        InetOrgPerson schema. The associated SRV record has Priority = 0.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        address-bound X.509 certificate for a Direct address in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase3Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase3KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase4" parent="discoveryTestcaseImpl"
        p:mailAddress="d4@domain2.#{ instanceConfig.domain }"
        p:name="D4_LDAP_DB_Valid"
        p:nameDisplay="D4 - Valid domain-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="2\, 3\, 5\, 6\, 7\, 8\, 9\, 10\, 11\, 12\, 13\, 14\, 15\, 16\, 17\, 19\, 20\, 21\, 22">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>
                            An invalid domain-bound certificate for the Direct address in an LDAP server with an
                            associated SRV record.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound certificates for other Direct addresses in an LDAP server
                            with an associated SRV record.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2798: Section 9.1.2</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid domain-bound certificate in an LDAP server with the appropriate mail attribute and
                        InetOrgPerson schema. The associated SRV record has Priority = 0.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        domain-bound X.509 certificate for a Direct address in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase4Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase4KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase5" parent="discoveryTestcaseImpl"
        p:mailAddress="d5@domain1.#{ instanceConfig.domain }"
        p:name="D5_DNS_AB_Invalid"
        p:nameDisplay="D5 - Invalid address-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtm="1\, 3"
                p:targetCertificate-ref="toolTestcaseConstantStrNone">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>An invalid address-bound certificate for the Direct address in a DNS CERT record.</dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound and domain-bound certificates for other Direct addresses in
                            DNS CERT records and an LDAP server with an associated SRV record.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and does
                        not select the associated invalid address-bound X.509 certificate.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase5Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase5KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase6" parent="discoveryTestcaseImpl"
        p:mailAddress="d6@domain4.#{ instanceConfig.domain }"
        p:name="D6_DNS_DB_Invalid"
        p:nameDisplay="D6 - Invalid domain-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtm="1\, 3"
                p:targetCertificate-ref="toolTestcaseConstantStrNone">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>An invalid domain-bound certificate for the Direct address in a DNS CERT record.</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for domain-bound CERT records and does not
                        select the associated invalid domain-bound X.509 certificate.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase6Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase6KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase7" parent="discoveryTestcaseImpl"
        p:mailAddress="d7@domain2.#{ instanceConfig.domain }"
        p:name="D7_LDAP_AB_Invalid"
        p:nameDisplay="D7 - Invalid address-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtm="3\, 22"
                p:targetCertificate-ref="toolTestcaseConstantStrNone">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>
                            An invalid address-bound certificate for the Direct address in an LDAP server with an
                            associated SRV record.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound and domain-bound certificates for other Direct addresses in
                            an LDAP server with an associated SRV record.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and does not select the
                        invalid address-bound X.509 certificate in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase7Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase7KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase8" parent="discoveryTestcaseImpl"
        p:mailAddress="d8@domain5.#{ instanceConfig.domain }"
        p:name="D8_LDAP_DB_Invalid"
        p:nameDisplay="D8 - Invalid domain-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtm="3\, 22"
                p:targetCertificate-ref="toolTestcaseConstantStrNone">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>
                            An invalid domain-bound certificate for the Direct address in an LDAP server with an
                            associated SRV record.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound certificates for other Direct addresses in an LDAP server
                            with an associated SRV record.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and does not select the
                        invalid domain-bound X.509 certificate in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase8Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase8KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase9" parent="discoveryTestcaseImpl"
        p:mailAddress="d9@domain1.#{ instanceConfig.domain }"
        p:name="D9_DNS_AB_SelectValid"
        p:nameDisplay="D9 - Select valid address-bound certificate over invalid certificate in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="1\, 3">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>An invalid address-bound certificate for the Direct address in a DNS CERT record.</dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound and domain-bound certificates for other Direct addresses in
                            DNS CERT records and an LDAP server with an associated SRV record.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid address-bound certificate in a DNS CERT record containing the Direct address in the
                        rfc822Name of the SubjectAlternativeName extension.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and select
                        the valid address-bound X.509 certificate instead of the invalid address-bound X.509 certificate.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase9Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase0KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase10" parent="discoveryTestcaseImpl"
        p:mailAddress="d10@domain3.#{ instanceConfig.domain }"
        p:name="D10_LDAP_AB_UnavailableLDAPServer"
        p:nameDisplay="D10 - Certificate discovery in LDAP with one unavailable LDAP server">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:backgroundCertificates-ref="toolTestcaseConstantStrNone"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="15\, 18">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2782: Page 3\, Priority Section</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                        InetOrgPerson schema. The associated SRV record has Priority = 1.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and attempts to connect
                        to an LDAP server based on the priority value specified in the SRV records until a successful
                        connection is made. Your system should first attempt to connect to an LDAP server associated with
                        an SRV record containing the lowest priority value (highest priority). Since this LDAP server is
                        unavailable, your system should then attempt to connect to the LDAP server associated with an SRV
                        record containing the second lowest priority value (second highest priority) and discover the valid
                        address-bound X.509 certificate in the available LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase10Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase10KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase11" parent="discoveryTestcaseImpl"
        p:mailAddress="d11@domain6.#{ instanceConfig.domain }"
        p:name="D11_DNS_NB_NoDNSCertsorSRV"
        p:nameDisplay="D11 - No certificates discovered in DNS CERT records and no SRV records">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:backgroundCertificates-ref="toolTestcaseConstantStrNone"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtm="1\, 3\, 18"
                p:targetCertificate-ref="toolTestcaseConstantStrNone">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system does not find any certificates when querying DNS for
                        CERT records and does not find any SRV records in DNS.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase11Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase11KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase12" parent="discoveryTestcaseImpl"
        p:mailAddress="d12@domain7.#{ instanceConfig.domain }"
        p:name="D12_LDAP_NB_UnavailableLDAPServer"
        p:nameDisplay="D12 - No certificates found in DNS CERT records and no available LDAP servers">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:backgroundCertificates-ref="toolTestcaseConstantStrNone"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtm="1\, 3\, 18"
                p:targetCertificate-ref="toolTestcaseConstantStrNone">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and attempts to connect
                        to an LDAP server associated with the only SRV record that should be found. Since this LDAP server
                        is unavailable or does not exist and no additional SRV records should have been found, your system
                        should not discover any X.509 certificates in either DNS CERT records or LDAP servers.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase12Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase12KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase13" parent="discoveryTestcaseImpl"
        p:mailAddress="d13@domain8.#{ instanceConfig.domain }"
        p:name="D13_LDAP_NB_NoCerts"
        p:nameDisplay="D13 - No certificates discovered in DNS CERT records or LDAP servers">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:backgroundCertificates-ref="toolTestcaseConstantStrNone"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtm="1\, 3\, 18"
                p:targetCertificate-ref="toolTestcaseConstantStrNone">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system does not discover any certificates in DNS CERT records
                        or LDAP servers when no certificates should be found.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase13Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase13KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase14" parent="discoveryTestcaseImpl"
        p:mailAddress="d14@domain1.#{ instanceConfig.domain }"
        p:name="D14_DNS_AB_TCPLargeCert"
        p:nameDisplay="D14 - Discovery of certificate larger than 512 bytes in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="1\, 3\, 4">
                <beans:property name="backgroundCertificates">
                    <dcdt:normalized-string>
                        Valid and invalid address-bound and domain-bound certificates for other Direct addresses in
                        DNS CERT records and an LDAP server with an associated SRV record.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>Direct Applicability Statement for Secure Health Transport: Section 5.4</dcdt:normalized-string>
                        <dcdt:normalized-string>RFC 1035: Section 4.2</dcdt:normalized-string>
                        <dcdt:normalized-string>RFC 4298: Section 4</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid address-bound certificate that is larger than 512 bytes in a DNS CERT record containing
                        the Direct address in the rfc822Name of the SubjectAlternativeName extension.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and discover
                        a valid address-bound X.509 certificate that is larger than 512 bytes using a TCP connection.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase14Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase14KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase15" parent="discoveryTestcaseImpl"
        p:mailAddress="d15@domain1.#{ instanceConfig.domain }"
        p:name="D15_DNS_AB_IPKIX"
        p:nameDisplay="D15 - Certificate discovery in DNS after IPKIX URL redirect">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="1\, 3">
                <beans:property name="backgroundCertificates">
                    <dcdt:normalized-string>
                        Valid and invalid address-bound and domain-bound certificates for other Direct addresses in
                        DNS CERT records and an LDAP server with an associated SRV record.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 4398: Section 2.1</dcdt:normalized-string>
                        <dcdt:normalized-string>Direct Applicability Statement for Secure Health Transport: Section 5.3</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A representation of a valid address-bound certificate served as the result of an IPKIX URL
                        redirect in DNS.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and discover
                        a representation of a valid address-bound X.509 certificate served as the result of an IPKIX URL redirect.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase15Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase15KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase16" parent="discoveryTestcaseImpl"
        p:mailAddress="d16@domain2.#{ instanceConfig.domain }"
        p:name="D16_LDAP_AB_SRVPriority"
        p:nameDisplay="D16 - Certificate discovery in LDAP based on SRV priority value">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="15\, 18">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>
                            An invalid address-bound certificate for the Direct address in an LDAP server. The associated
                            SRV record has Priority = 1.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            Valid and invalid address-bound and domain-bound certificates for other Direct addresses in
                            an LDAP server with an associated SRV record.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2782: Page 3\, Priority Section</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                        InetOrgPerson schema. The associated SRV record has Priority = 0.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        address-bound X.509 certificate in the LDAP server associated with an SRV record containing the
                        lowest priority value (highest priority).
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase16Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase16KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase17" parent="discoveryTestcaseImpl"
        p:mailAddress="d17@domain5.#{ instanceConfig.domain }"
        p:name="D17_LDAP_AB_SRVWeight"
        p:nameDisplay="D17 - Certificate discovery in LDAP based on SRV weight value">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtm="16\, 18">
                <beans:property name="backgroundCertificates">
                    <util:list>
                        <dcdt:normalized-string>
                            An invalid address-bound certificate in an LDAP server with the appropriate mail attribute and
                            InetOrgPerson schema. The associated SRV record has Priority = 0 and Weight = 0.
                        </dcdt:normalized-string>
                        <dcdt:normalized-string>
                            An invalid domain-bound certificate for another Direct address in an LDAP server associated
                            with an SRV record that has Priority = 0 and Weight = 0.
                        </dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2782: Page 3\, Weight Section</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="targetCertificate">
                    <dcdt:normalized-string>
                        A valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                        InetOrgPerson schema. The associated SRV record has Priority = 0 and Weight = 100.
                    </dcdt:normalized-string>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        address-bound X.509 certificate in the LDAP server associated with an SRV record containing the
                        lowest priority value (highest priority) and the highest weight value when SRV records with the
                        same priority value exist.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <!-- TODO: implement Discovery testcase credential configs -->
                <!--
                <beans:bean parent="discoveryTestcaseLeafCred">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="credConfigImpl"
                            p:certificateDescriptor-ref="discoveryTestcase17Cert1Config"
                            p:keyPairDescriptor-ref="discoveryTestcase17KeyPair1Config"/>
                    </beans:property>
                </beans:bean>
                -->
            </util:list>
        </beans:property>
    </beans:bean>
</beans:beans>