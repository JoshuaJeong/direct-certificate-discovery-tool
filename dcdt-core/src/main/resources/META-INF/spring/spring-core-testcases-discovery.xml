<?xml version="1.0" encoding="UTF-8"?>
<beans:beans
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:c="http://www.springframework.org/schema/c"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:dcdt="http://direct-test.com/spring/schema/spring-dcdt"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://direct-test.com/spring/schema/spring-dcdt http://direct-test.com/spring/schema/spring-dcdt.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">
    
    <!--====================================================================================================
    = DISCOVERY TESTCASE STRINGS
    =====================================================================================================-->
    <dcdt:normalized-string id="discoveryTestcaseConstantStrVerifyEmail">
        You should have received an email indicating the test case results for your system. Examine the results
        to see if your system passed the test case. If you do not receive a message for the test case, then you
        should assume that the test case failed.
    </dcdt:normalized-string>
    
    <dcdt:normalized-string id="discoveryTestcaseConstantStrVerifyNoEmail">
        Verify that your system did NOT send an email because it could not find a certificate for the Direct address.
        To pass this test case, you must NOT receive an email in response.
    </dcdt:normalized-string>

    <!--====================================================================================================
    = DISCOVERY TESTCASE DESCRIPTIONS
    =====================================================================================================-->
    <beans:bean id="discoveryTestcaseDesc" class="gov.hhs.onc.dcdt.testcases.discovery.DiscoveryTestcaseDescription" parent="toolTestcaseDesc" abstract="true"/>
    <beans:bean id="discoveryTestcaseDescImpl" class="gov.hhs.onc.dcdt.testcases.discovery.impl.DiscoveryTestcaseDescriptionImpl" parent="discoveryTestcaseDesc"
        abstract="true"/>

    <!--====================================================================================================
    = DISCOVERY TESTCASE MAIL MAPPINGS
    =====================================================================================================-->
    <beans:bean id="discoveryTestcaseMailMapping" class="gov.hhs.onc.dcdt.testcases.discovery.mail.DiscoveryTestcaseMailMapping" abstract="true"/>
    
    <beans:bean id="discoveryTestcaseMailMappingImpl" class="gov.hhs.onc.dcdt.testcases.discovery.mail.impl.DiscoveryTestcaseMailMappingFactoryBean"
        parent="discoveryTestcaseMailMapping" lazy-init="true" scope="prototype"/>

    <!--====================================================================================================
    = DISCOVERY TESTCASES
    =====================================================================================================-->
    <beans:bean id="discoveryTestcase" class="gov.hhs.onc.dcdt.testcases.discovery.DiscoveryTestcase" parent="toolTestcase" abstract="true"/>
    <beans:bean id="discoveryTestcaseImpl" class="gov.hhs.onc.dcdt.testcases.discovery.impl.DiscoveryTestcaseFactoryBean" parent="discoveryTestcase"
        abstract="true"/>
    
    <beans:bean id="discoveryTestcaseNeg" parent="discoveryTestcaseImpl" abstract="true"
        p:negative="true"/>
    
    <beans:bean id="discoveryTestcase1" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig1.mailAddress }"
        p:name="D1_DNS_AB_Valid"
        p:nameDisplay="D1 - Valid address-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="1,3">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 4398: Section 2.1</dcdt:normalized-string>
                        <dcdt:normalized-string>Direct Applicability Statement for Secure Health Transport: Sections 4.0 and 5.3</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and discover
                        a valid address-bound X.509 certificate for a Direct address.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="ADDRESS"
                    p:name="D1_valA"
                    p:nameDisplay="D1_valA">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D1_valA"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate in a DNS CERT record containing the Direct address in the rfc822Name of the
                                    SubjectAlternativeName extension.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Dns"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackgroundInvalid"
                    p:bindingType="DOMAIN"
                    p:name="D1_invB"
                    p:nameDisplay="D1_invB">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D1_invB"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid domain-bound certificate for the Direct address in a DNS CERT record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Dns"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackgroundInvalid"
                    p:bindingType="ADDRESS"
                    p:name="D1_invC"
                    p:nameDisplay="D1_invC">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D1_invC"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid address-bound certificate for the Direct address in an LDAP server with an associated SRV record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Ldap1"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackgroundInvalid"
                    p:bindingType="DOMAIN"
                    p:name="D1_invD"
                    p:nameDisplay="D1_invD">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D1_invD"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid domain-bound certificate for the Direct address in an LDAP server with an associated SRV record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Ldap1"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase2" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig2.mailAddress }"
        p:name="D2_DNS_DB_Valid"
        p:nameDisplay="D2 - Valid domain-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="1,3">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 4398: Section 2.1</dcdt:normalized-string>
                        <dcdt:normalized-string>Direct Applicability Statement for Secure Health Transport: Sections 4.0 and 5.3</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for domain-bound CERT records and discover
                        a valid domain-bound X.509 certificate for a Direct address.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="DOMAIN"
                    p:name="D2_valB"
                    p:nameDisplay="D2_valB">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D2_valB"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid domain-bound certificate in a DNS CERT record containing the Direct address' domain name
                                    in the dNSName of the SubjectAlternativeName extension.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Dns"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackgroundInvalid"
                    p:bindingType="ADDRESS"
                    p:name="D2_invC"
                    p:nameDisplay="D2_invC">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D2_invC"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid address-bound certificate for the Direct address in an LDAP server with an associated SRV record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Ldap1"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackgroundInvalid"
                    p:bindingType="DOMAIN"
                    p:name="D2_invD"
                    p:nameDisplay="D2_invD">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D2_invD"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid domain-bound certificate for the Direct address in an LDAP server with an associated SRV record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Ldap1"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase3" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig3.mailAddress }"
        p:name="D3_LDAP_AB_Valid"
        p:nameDisplay="D3 - Valid address-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,19,20,21,22">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2798: Section 9.1.2</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        address-bound X.509 certificate for a Direct address in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="ADDRESS"
                    p:name="D3_valC"
                    p:nameDisplay="D3_valC">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D3_valC"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                                    InetOrgPerson schema. The associated SRV record has Priority = 0.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc2Ldap1"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackgroundInvalid"
                    p:bindingType="DOMAIN"
                    p:name="D3_invD"
                    p:nameDisplay="D3_invD">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D3_invD"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid domain-bound certificate for the Direct address in an LDAP server with
                                    an associated SRV record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc2Ldap1"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase4" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig4.mailAddress }"
        p:name="D4_LDAP_DB_Valid"
        p:nameDisplay="D4 - Valid domain-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,19,20,21,22">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2798: Section 9.1.2</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        domain-bound X.509 certificate for a Direct address in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="DOMAIN"
                    p:name="D4_valD"
                    p:nameDisplay="D4_valD">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D4_valD"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid domain-bound certificate in an LDAP server with the appropriate mail attribute and
                                    InetOrgPerson schema. The associated SRV record has Priority = 0.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc2Ldap1"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase5" parent="discoveryTestcaseNeg"
        p:mailAddress="#{ instanceMailAddrConfig5.mailAddress }"
        p:name="D5_DNS_AB_Invalid"
        p:nameDisplay="D5 - Invalid address-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtmSections="1,3">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and finds,
                        but does not select the associated invalid address-bound X.509 certificate.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTargetInvalid"
                    p:bindingType="ADDRESS"
                    p:name="D5_invA"
                    p:nameDisplay="D5_invA">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D5_invA"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    An invalid address-bound certificate for the Direct address in a DNS CERT record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Dns"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase6" parent="discoveryTestcaseNeg"
        p:mailAddress="#{ instanceMailAddrConfig6.mailAddress }"
        p:name="D6_DNS_DB_Invalid"
        p:nameDisplay="D6 - Invalid domain-bound certificate discovery in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtmSections="1,3">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for domain-bound CERT records and finds,
                        but does not select the associated invalid domain-bound X.509 certificate.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTargetInvalid"
                    p:bindingType="DOMAIN"
                    p:name="D6_invB"
                    p:nameDisplay="D6_invB">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D6_invB"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    An invalid domain-bound certificate for the Direct address in a DNS CERT record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc4Dns"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase7" parent="discoveryTestcaseNeg"
        p:mailAddress="#{ instanceMailAddrConfig7.mailAddress }"
        p:name="D7_LDAP_AB_Invalid"
        p:nameDisplay="D7 - Invalid address-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtmSections="3,22">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and finds, but
                        does not select the invalid address-bound X.509 certificate in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTargetInvalid"
                    p:bindingType="ADDRESS"
                    p:name="D7_invC"
                    p:nameDisplay="D7_invC">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D7_invC"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid address-bound certificate for the Direct address in an LDAP server with
                                    an associated SRV record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc2Ldap1"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase8" parent="discoveryTestcaseNeg"
        p:mailAddress="#{ instanceMailAddrConfig8.mailAddress }"
        p:name="D8_LDAP_DB_Invalid"
        p:nameDisplay="D8 - Invalid domain-bound certificate discovery in LDAP">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtmSections="3,22">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and finds, but does not
                        select the invalid domain-bound X.509 certificate in the associated LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTargetInvalid"
                    p:bindingType="DOMAIN"
                    p:name="D8_invD"
                    p:nameDisplay="D8_invD">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D8_invD"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid domain-bound certificate for the Direct address in an LDAP server with
                                    an associated SRV record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc5Ldap3"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase9" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig9.mailAddress }"
        p:name="D9_DNS_AB_SelectValid"
        p:nameDisplay="D9 - Select valid address-bound certificate over invalid certificate in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="1,3">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and select
                        the valid address-bound X.509 certificate instead of the invalid address-bound X.509 certificate.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="ADDRESS"
                    p:name="D9_valA"
                    p:nameDisplay="D9_valA">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D9_valA"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate in a DNS CERT record containing the Direct address
                                    in the rfc822Name of the SubjectAlternativeName extension.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Dns"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafTargetInvalid"
                    p:bindingType="ADDRESS"
                    p:name="D9_invA"
                    p:nameDisplay="D9_invA">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D9_invA"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid address-bound certificate for the Direct address in a DNS CERT record.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Dns"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase10" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig10.mailAddress }"
        p:name="D10_LDAP_AB_UnavailableLDAPServer"
        p:nameDisplay="D10 - Certificate discovery in LDAP with one unavailable LDAP server">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="15,18">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2782: Page 3, Priority Section</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and attempts to connect
                        to an LDAP server based on the priority value specified in the SRV records until a successful
                        connection is made. Your system should first attempt to connect to an LDAP server associated with
                        an SRV record containing the lowest priority value (highest priority). Since this LDAP server is
                        unavailable, your system should then attempt to connect to the LDAP server associated with an SRV
                        record containing the second lowest priority value (second highest priority) and discover the valid
                        address-bound X.509 certificate in the available LDAP server.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="ADDRESS"
                    p:name="D10_valE"
                    p:nameDisplay="D10_valE">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D10_valE"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                                    InetOrgPerson schema. The associated SRV record has Priority = 1.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc3Ldap2"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase11" parent="discoveryTestcaseNeg"
        p:mailAddress="#{ instanceMailAddrConfig11.mailAddress }"
        p:name="D11_DNS_NB_NoDNSCertsorSRV"
        p:nameDisplay="D11 - No certificates discovered in DNS CERT records and no SRV records">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtmSections="1,3,18">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system does not find any certificates when querying DNS for
                        CERT records and does not find any SRV records in DNS.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list/>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase12" parent="discoveryTestcaseNeg"
        p:mailAddress="#{ instanceMailAddrConfig12.mailAddress }"
        p:name="D12_LDAP_NB_UnavailableLDAPServer"
        p:nameDisplay="D12 - No certificates found in DNS CERT records and no available LDAP servers">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtmSections="1,3,18">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and attempts to connect
                        to an LDAP server associated with the only SRV record that should be found. Since this LDAP server
                        is unavailable or does not exist and no additional SRV records should have been found, your system
                        should not discover any X.509 certificates in either DNS CERT records or LDAP servers.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list/>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase13" parent="discoveryTestcaseNeg"
        p:mailAddress="#{ instanceMailAddrConfig13.mailAddress }"
        p:name="D13_LDAP_NB_NoCerts"
        p:nameDisplay="D13 - No certificates discovered in DNS CERT records or LDAP servers">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyNoEmail"
                p:rtmSections="1,3,18">
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system does not discover any certificates in DNS CERT records
                        or LDAP servers when no certificates should be found.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list/>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase14" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig14.mailAddress }"
        p:name="D14_DNS_AB_TCPLargeCert"
        p:nameDisplay="D14 - Discovery of certificate larger than 512 bytes in DNS">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="1,3,4">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>Direct Applicability Statement for Secure Health Transport: Section 5.4</dcdt:normalized-string>
                        <dcdt:normalized-string>RFC 1035: Section 4.2</dcdt:normalized-string>
                        <dcdt:normalized-string>RFC 4298: Section 4</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for address-bound CERT records and discover
                        a valid address-bound X.509 certificate that is larger than 512 bytes using a TCP connection.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="ADDRESS"
                    p:name="D14_valA"
                    p:nameDisplay="D14_valA">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D14_valA"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                            <beans:property name="keyDescriptor">
                                <beans:bean parent="discoveryTestcaseKeyConfigLeaf4kb"/>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate that is larger than 512 bytes in a DNS CERT record containing
                                    the Direct address in the rfc822Name of the SubjectAlternativeName extension.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc1Dns"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase15" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig15.mailAddress }"
        p:name="D15_LDAP_AB_SRVPriority"
        p:nameDisplay="D15 - Certificate discovery in LDAP based on SRV priority value">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="15,18">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2782: Page 3, Priority Section</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        address-bound X.509 certificate in the LDAP server associated with an SRV record containing the
                        lowest priority value (highest priority).
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="ADDRESS"
                    p:name="D15_valC"
                    p:nameDisplay="D15_valC">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D15_valC"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                                    InetOrgPerson schema. The associated SRV record has Priority = 0.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc2Ldap1"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackgroundInvalid"
                    p:bindingType="ADDRESS"
                    p:name="D15_invE"
                    p:nameDisplay="D15_invE">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeafExpired">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D15_invE"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Invalid address-bound certificate for the Direct address in an LDAP server. The associated
                                    SRV record has Priority = 1.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc2Ldap2"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>

    <beans:bean id="discoveryTestcase16" parent="discoveryTestcaseImpl"
        p:mailAddress="#{ instanceMailAddrConfig16.mailAddress }"
        p:name="D16_LDAP_AB_SRVWeight"
        p:nameDisplay="D16 - Certificate discovery in LDAP based on SRV weight value">
        <beans:property name="description">
            <beans:bean parent="discoveryTestcaseDescImpl"
                p:instructions-ref="discoveryTestcaseConstantStrVerifyEmail"
                p:rtmSections="16,18">
                <beans:property name="specifications">
                    <util:list>
                        <dcdt:normalized-string>RFC 2782: Page 3, Weight Section</dcdt:normalized-string>
                    </util:list>
                </beans:property>
                <beans:property name="text">
                    <dcdt:normalized-string>
                        This test case verifies that your system can query DNS for SRV records and discover a valid
                        address-bound X.509 certificate in the LDAP server associated with an SRV record containing the
                        lowest priority value (highest priority) and the highest weight value when SRV records with the
                        same priority value exist.
                    </dcdt:normalized-string>
                </beans:property>
            </beans:bean>
        </beans:property>
        <beans:property name="credentials">
            <util:list>
                <beans:bean parent="discoveryTestcaseCredLeafTarget"
                    p:bindingType="ADDRESS"
                    p:name="D16_valC"
                    p:nameDisplay="D16_valC">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D16_valC"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                                    InetOrgPerson schema. The associated SRV record has Priority = 0 and Weight = 100.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc5Ldap3"/>
                    </beans:property>
                </beans:bean>
                <beans:bean parent="discoveryTestcaseCredLeafBackground"
                    p:bindingType="ADDRESS"
                    p:name="D16_valE"
                    p:nameDisplay="D16_valE">
                    <beans:property name="credentialConfig">
                        <beans:bean parent="discoveryTestcaseCredConfigLeaf">
                            <beans:property name="certificateDescriptor">
                                <beans:bean parent="discoveryTestcaseCertConfigLeaf">
                                    <beans:property name="subjectName">
                                        <beans:bean parent="certNameImpl"
                                            p:commonName="D16_valE"/>
                                    </beans:property>
                                </beans:bean>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="description">
                        <beans:bean parent="discoveryTestcaseCredDescImpl">
                            <beans:property name="text">
                                <dcdt:normalized-string>
                                    Valid address-bound certificate in an LDAP server with the appropriate mail attribute and
                                    InetOrgPerson schema. The associated SRV record has Priority = 0 and Weight = 0.
                                </dcdt:normalized-string>
                            </beans:property>
                        </beans:bean>
                    </beans:property>
                    <beans:property name="location">
                        <beans:bean parent="discoveryTestcaseCredLoc5Ldap1"/>
                    </beans:property>
                </beans:bean>
            </util:list>
        </beans:property>
    </beans:bean>
</beans:beans>