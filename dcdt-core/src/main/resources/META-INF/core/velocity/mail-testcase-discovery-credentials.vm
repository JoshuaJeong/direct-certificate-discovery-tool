#* @vtlvariable name="discoveryTestcaseResult" type="gov.hhs.onc.dcdt.testcases.discovery.results.DiscoveryTestcaseResult" *#
#* @vtlmacrolibrary path="lib/core.vm" *#
#set ( $credExpectedMsg = "Certificate Expected")
#set ( $credFoundMsg = "Certificate Found")

#macro ( credDescription $credMsg )
    #if($credMsg == $credExpectedMsg)
        #set( $cred = $discoveryTestcaseResult.credentialExpected)
    #else
        #set( $cred = $discoveryTestcaseResult.credentialFound)
    #end

    <li><strong>$credMsg</strong>:
        #if($cred)
            <ul>
                <li><strong>Name</strong>: $cred.name</li>
                <li><strong>Valid</strong>: $cred.valid</li>
                <li><strong>Binding Type</strong>: $cred.bindingType</li>
                <li><strong>Location</strong>:/li>
                    #set ($loc = $cred.location)
                    <ul>
                        <li><strong>Type</strong>: $loc.type</li>
                        <li><strong>Mail Address</strong>: $loc.mailAddress.toAddress()</li>
                        #if($loc.hasLdapConfig())
                            #set( $ldapConfig = $loc.ldapConfig)
                            <li><strong>Host</strong>: $ldapConfig.host</li>
                            <li><strong>Port</strong>: $ldapConfig.port</li>
                        #end
                    </ul>
                <li><strong>Description</strong>: $cred.description.text/li>
            </ul>
        #else
            None
        #end
    </li>
    <br/>
#end